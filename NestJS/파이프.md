### 파이프

요청이 라우터 핸들러로 전달되기 전에 요청 객체를 변환할 수 있는 기회를 제공한다. 

- 라우터 핸들러: 웹 프레임워크에서 사용자의 요청을 처리하는 엔드포인트(쉽게 이야기해서 URL)마다 동작을 수행하는 컴포넌트로, 라우터 핸들러가 요청 경로와 컨트롤러를 매핑해준다고 이해하면 된다. 
- 미들웨어의 역할과 비슷하다고 할 수 있지만 미들웨어는 애플리케이션의 모든 콘텍스트에서 사용하도록 할 수 없다. (미들웨어는 현재 요청이 어떤 핸들러에서 수행되는지, 어떤 매개변수를 가지고 있는지에 대한 실행 콘텍스트를 알지 못하기 때문)

파이프는 보통 다음 2가지의 목적으로 사용한다.

- 변환: 입력 데이터를 원하는 형식으로 변환
- 유효성 검사: 입력 데이터가 사용자가 정한 기준에 유효하지 않은 경우 예외 처리 

`@nest/common` 패키지에는 여러 내장 파이프가 마련되어 있다.

- `DefaultValuePipe`는 인수의 값에 기본값을 설정할 때 사용한다. 쿼리 매개변수가 생략된 경우 유용하게 사용할 수 있다. 

`@Param` 데커레이터의 <ins>두 번째 인수로 파이프를 넘겨</ins> 현재 실행 콘텍스트에 바인딩할 수 있다. 

```
@Get(':id')
findOne(@Param('id', ParseIntPipe) id: number) { ... }
```

클래스를 전달하지 않고 파이프 객체를 직접 생성하여 전달할 수도 있다. 생성할 파이프 객체의 동작을 원하는 대로 바꾸고자 할 때 사용한다.

```
@Get(':id')
findOne(@Param('id', new ParseIntPipe({ errorHttpStatusCode: HttpStatus.NOT_ACCEPTABLE })) id: number) { 
	... 
}
```

- 상태 코드를 406 Not Acceptable로 변경해서 내보낸다.

<br>

### 참고

NestJS로 배우는 백엔드 프로그래밍
